<html>
<head>

	<title>Camera Configuration Calculus</title>

	<link rel="stylesheet" href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css">

	<script type="text/javascript">

		function toggle()
		{
			var line = document.getElementById('CycleTimeTargetLine');
			var frame = document.getElementById('CycleTimeTargetFrame');

			if (line.checked)
			{
				line.checked = false;
				frame.checked = true;
			}
			else if (frame.checked)
			{
				line.checked = true;
				frame.checked = false;
			}

			update();
		}

		function update()
		{
			var elements =
			{
				ImageWidth: document.getElementById('ImageWidth'),
				ImageHeight: document.getElementById('ImageHeight'),
				ImageChannels: document.getElementById('ImageChannels'),
				CameraCount: document.getElementById('CameraCount'),
				CycleTime: document.getElementById('CycleTime'),
				CycleTimeUnit: document.getElementById('CycleTimeUnit'),
				CycleTimeTargetLine: document.getElementById('CycleTimeTargetLine'),
				CycleTimeTargetFrame: document.getElementById('CycleTimeTargetFrame'),

				LineCycleTime: document.getElementById('LineCycleTime'),
				LineCycleTimeUnit: document.getElementById('LineCycleTimeUnit'),
				FrameCycleTime: document.getElementById('FrameCycleTime'),
				FrameCycleTimeUnit: document.getElementById('FrameCycleTimeUnit'),
				LinesPerSecond: document.getElementById('LinesPerSecond'),
				FramesPerSecond: document.getElementById('FramesPerSecond'),
				BytesPerFrame: document.getElementById('BytesPerFrame'),
				GigabitPerSecond: document.getElementById('GigabitPerSecond'),
			};

			var input =
			{
				image:
				{
					width: NaN,
					height: NaN,
					channels: NaN,
				},
				camera:
				{
					count: NaN,
					cycletime: NaN,
				}
			};

			input.image.width = parseInt(elements.ImageWidth.value);
			input.image.height = parseInt(elements.ImageHeight.value);
			input.image.channels = parseInt(elements.ImageChannels.value);
			input.camera.count = parseInt(elements.CameraCount.value);
			input.camera.cycletime = parseFloat(elements.CycleTime.value.replace(',', '.'));

			if (elements.CycleTimeTargetLine.checked)
			{
				input.camera.cycletime *= 1e-6;
			}

			if (elements.CycleTimeTargetFrame.checked)
			{
				input.camera.cycletime *= 1e-6;
				input.camera.cycletime /= input.image.height;
			}

			var output =
			{
				line:
				{
					cycletime: NaN,
					frequency: NaN,
					bytes: NaN,
				},
				frame:
				{
					cycletime: NaN,
					frequency: NaN,
					bytes: NaN,
				},
				gbps: NaN
			};

			output.line.cycletime = input.camera.cycletime * 1e+6;
			output.frame.cycletime = input.image.height * input.camera.cycletime * 1e+6;

			output.line.frequency = Math.round(1 / (input.camera.cycletime));
			output.frame.frequency = Math.round(1 / (input.image.height * input.camera.cycletime));

			output.line.bytes = input.image.width * input.image.channels;
			output.frame.bytes = input.image.height * input.image.width * input.image.channels;

			output.gbps = input.camera.count * output.frame.frequency * output.frame.bytes * (8 / Math.pow(1024, 3));

			elements.CycleTimeUnit.innerHTML = '[&micro;s]';
			elements.LineCycleTimeUnit.innerHTML = '[&micro;s]';
			elements.FrameCycleTimeUnit.innerHTML = '[&micro;s]';

			elements.LineCycleTime.value = output.line.cycletime;
			elements.FrameCycleTime.value = output.frame.cycletime;

			elements.LinesPerSecond.value = output.line.frequency;
			elements.FramesPerSecond.value = output.frame.frequency;

			elements.BytesPerFrame.value = output.frame.bytes;
			elements.GigabitPerSecond.value = output.gbps;
		}

	</script>

</head>
<body class="p-0 m-0 bg-white text-black">

	<div class="container mx-auto">

		<div class="mt-3 mx-3 text-xl font-medium">Camera Configuration Calculus</div>

		<div class="flex flex-row flex-wrap">

			<div class="flex-1 p-3 space-y-3">

				<div class="flex flex-col">
					<label for="ImageWidth">Image Width</label>
					<input type="text" id="ImageWidth" onclick="this.select()" onkeyup="update()" value="1000">
				</div>

				<div class="flex flex-col">
					<label for="ImageHeight">Image Height</label>
					<input type="text" id="ImageHeight" onclick="this.select()" onkeyup="update()" value="1">
				</div>

				<div class="flex flex-col">
					<label for="ImageChannels">Image Channels</label>
					<input type="text" id="ImageChannels" onclick="this.select()" onkeyup="update()" value="1">
				</div>

				<div class="flex flex-col">
					<label for="CameraCount">Camera Count</label>
					<input type="text" id="CameraCount" onclick="this.select()" onkeyup="update()" value="1">
				</div>

				<div class="flex flex-col">
					<label for="CycleTime">Cycle Time <span class="text-gray-500" id="CycleTimeUnit"></span></label>
					<input type="text" id="CycleTime" onclick="this.select()" onkeyup="update()" value="1000">
				</div>

				<div class="flex flex-col">
					<label onclick="toggle()">Cycle Target</label>
					<div>
						<input type="radio" id="CycleTimeTargetLine" name="CycleTimeTarget" onclick="update()" checked>
						<label for="CycleTimeTargetLine">Line</label>
						&nbsp;
						<input type="radio" id="CycleTimeTargetFrame" name="CycleTimeTarget" onclick="update()">
						<label for="CycleTimeTargetFrame">Frame</label>
					</div>
				</div>

			</div>

			<div class="flex-1 p-3 space-y-3">

				<div class="flex flex-col">
					<label for="LineCycleTime">Line Cycle Time <span class="text-gray-500" id="LineCycleTimeUnit"></span></label>
					<input type="text" id="LineCycleTime" readonly>
				</div>

				<div class="flex flex-col">
					<label for="FrameCycleTime">Frame Cycle Time <span class="text-gray-500" id="FrameCycleTimeUnit"></span></label>
					<input type="text" id="FrameCycleTime" readonly>
				</div>

				<div class="flex flex-col">
					<label for="LinesPerSecond">Lines Per Second</label>
					<input type="text" id="LinesPerSecond" readonly>
				</div>

				<div class="flex flex-col">
					<label for="FramesPerSecond">Frames Per Second</label>
					<input type="text" id="FramesPerSecond" readonly>
				</div>

				<div class="flex flex-col">
					<label for="BytesPerFrame">Bytes Per Frame</label>
					<input type="text" id="BytesPerFrame" readonly>
				</div>

				<div class="flex flex-col">
					<label for="GigabitPerSecond">Total Throughput <span class="text-gray-500">[Gbit/s]</span></label>
					<input type="text" id="GigabitPerSecond" readonly>
				</div>

			</div>

		</div>

	</div>

	<script type="text/javascript">

		var labels = document.getElementsByTagName('label');

		for (var i = 0; i < labels.length; i++)
		{
			labels[i].className += ' mb-1 font-light';
		}

		var inputs = document.getElementsByTagName('input');

		for (var i = 0; i < inputs.length; i++)
		{
			if (inputs[i].type == 'text')
			{
				inputs[i].className += ' p-1 border rounded font-light';

				if (inputs[i].readOnly)
				{
					inputs[i].className += ' bg-gray-50';
				}
			}
		}

		window.addEventListener('load', update);

	</script>

</body>
</html>
